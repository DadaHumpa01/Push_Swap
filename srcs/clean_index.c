/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   clean_index.c                                      :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: danilo <danilo@student.42.fr>              +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2021/05/25 21:26:37 by danilo            #+#    #+#             */
/*   Updated: 2021/05/30 19:26:54 by danilo           ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "pushswap.h"

int	numero_mag_in_sott(t_world *all)
{
	t_a		*tmp;
	long	num;
	int		index;

	index = 0;
	tmp = *all->a;
	num = -2147483649;
	while (tmp != NULL)
	{
		if (tmp->val > num && tmp->index < index)
		{	
			index = tmp->index;
			num = tmp->val;
		}
		tmp = tmp->next;
	}
	return (num);
}

void	check_ott(t_world *all)
{
	t_a *tmp;
	int minus;
	int val;

	val = numero_mag_in_sott(all);
	minus = 0;
	tmp = *all->a;
	while (tmp != NULL)
	{
		if (tmp->index < 0)
			minus = 1;
		if (tmp->val > val && minus == 0)
		{
			tmp->index = -1;
			val = tmp->val;
		}
		tmp = tmp->next;
	}
}

void	check_value_max_recursive(t_world *all, t_a *tmp)
{
	if (tmp->next == NULL)
		all->val_close_list = tmp->val;
	else
		check_value_max_recursive(all, tmp->next);
}

void	move_in_b_by_index(t_world *all, t_a *tmp, int num, int minus)
{
	if (tmp->index < 0)
		reverse_rotate_a(all);
	else
		push_b(all);
	new_list_recursive(all, num, minus);
}

void	new_list_recursive(t_world *all, int num, int minus)
{
	t_a	*tmp;

	tmp = *all->a;
	if (tmp->val == all->val_close_list)
	{
		if (tmp->index >= 1)
			push_b(all);
		return ;
	}
	else
		move_in_b_by_index(all, tmp, num, minus);
}

void	check_value(t_world *all)
{
	t_a	*tmp;
	int num;

	tmp = *all->a;
	num = numero_mag_in_sott(all);
	check_value_max_recursive(all, tmp);
	check_ott(all);
	new_list_recursive(all, num, 0);
}

//381 197 333 357 930 83 550 0 945 651 994 69 929 571 745 288 839 229 464 172 42 278 193 773 383 217 920 474 977 926 379 280 630 232 58 564 652 493 286 80 329 373 498 372 865 914 986 632 228 255 413 118 301 101 74 512 445 224 394 790 877 737 638 870 898 555 644 665 917 306 94 195 752 327 427 45 111 507 292 354 514 885 152 637 991 168 614 593 895 81 323 861 722 751 473 259 969 526 371 467 842 422 135 330 741 598 663 53 461 943 430 204 186 580 979 983 46 9 690 444 893 154 78 415 907 864 626 147 572 540 932 694 794 712 16 786 846 528 40 225 802 414 156 658 336 406 237 916 534 631 997 51 167 210 603 317 779 886 385 344 265 953 532 938 100 605 819 565 472 251 293 771 449 591 77 358 538 928 799 838 129 585 821 723 995 440 133 403 668 900 919 542 470 338 974 992 226 824 947 98 908 726 862 892 453 103 222 332 622 586 247 56 535 683 421 716 466 891 902 519 18 418 4 216 59 65 185 360 488 238 788 653 491 677 744 19 667 816 689 910 347 869 240 522 529 339 615 809 341 533 356 884 988 112 518 817 351 956 785 223 123 387 242 811 607 521 975 252 291 503 13 481 310 909 867 863 151 738 715 676 134 431 656 261 678 948 107 661 320 160 161 805 428 220 567 912 115 166 597 277 721 458 48 257 322 425 54 675 697 281 109 219 730 231 490 180 642 391 858 546 939 594 478 346 209 243 456 881 740 619 748 321 84 70 552 961 601 501 859 756 62 589 368 993 79 783 23 520 434 215 325 390 987 318 834 106 543 687 221 300 742 551 408 719 787 767 380 525 315 245 897 784 500 553 921 827 557 244 263 625 708 26 17 120 587 962 903 608 582 82 763 397 944 952 927 283 648 496 904 618 705 686 436 398 813 764 851 289 548 494 206 724 369 349 905 524 669 972 190 679 201 311 765 14 688 814 483 505 896 964 873 326 853 275 940 510 2 73 35 860 717 314 55 776 544 978 700 770 110 725 562 578 718 950 699 30 918 362 996 86 955 780 664 49 801 954 170 249 417 299 890 781 350 22 727 782 857 732 284 39 460 150 560 34 296 448 227 942 600 899 798 471 662 848 352 836 772 366 93 682